(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/Authorize"],{3474:function(t,e,a){"use strict";a.r(e);var n=a("f8cd"),o=a("56a0");for(var i in o)"default"!==i&&function(t){a.d(e,t,(function(){return o[t]}))}(i);a("eca8");var u,d=a("f0c5"),s=Object(d["a"])(o["default"],n["b"],n["c"],!1,null,"03cc894a",null,!1,n["a"],u);e["default"]=s.exports},"56a0":function(t,e,a){"use strict";a.r(e);var n=a("56ee"),o=a.n(n);for(var i in n)"default"!==i&&function(t){a.d(e,t,(function(){return n[t]}))}(i);e["default"]=o.a},"56ee":function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=c(a("c2aa")),o=a("f00d"),i=a("0dd7"),u=a("26cb"),d=c(a("4965")),s=c(a("8e68"));function c(t){return t&&t.__esModule?t:{default:t}}var r=getApp(),l={name:"Authorize",props:{isAuto:{type:Boolean,default:!0},isGoIndex:{type:Boolean,default:!0},isShowAuth:{type:Boolean,default:!1}},data:function(){return{logoUrl:"",authKey:""}},computed:(0,u.mapGetters)(["isLogin","userInfo"]),watch:{isLogin:function(t){!0===t&&this.$emit("onLoadFun",this.userInfo)}},mounted:function(){this.getLogoUrl();var t=this;this.isLogin||n.default.has(i.STATE_R_KEY)?this.setAuthStatus():wx.login({success:function(e){n.default.set(i.STATE_R_KEY,e.code,10800);var a=r.globalData.spid?r.globalData.spid:"";(0,o.silenceAuth)({code:e.code,spread:a,spid:r.globalData.code}).then((function(e){if(void 0!==e.data.key&&e.data.key)t.authKey=e.data.key;else{r.globalData.code=0;var a=e.data.expires_time-n.default.time();s.default.commit("LOGIN",{token:e.data.token,time:a})}})).catch((function(t){}))}})},methods:{setAuthStatus:function(){var t=this;d.default.authorize().then((function(e){!1===e.islogin?t.setUserInfo():t.$emit("onLoadFun",t.userInfo)})).catch((function(e){t.isAuto&&t.$emit("authColse",!0)}))},getUserInfo:function(e){var a=this;d.default.getUserInfo().then((function(n){var o=n.userInfo;o.code=e,o.spread_spid=r.globalData.spid,o.spread_code=r.globalData.code,d.default.authUserInfo(o).then((function(e){t.hideLoading(),a.$emit("authColse",!1),a.$emit("onLoadFun",a.userInfo)})).catch((function(e){t.hideLoading(),t.showToast({title:e.msg,icon:"none",duration:2e3})}))})).catch((function(e){t.hideLoading()}))},getUserPhoneNumber:function(e,a,n){var i=this;(0,o.getUserPhone)({encryptedData:e,iv:a,code:n,spid:r.globalData.spid,spread:r.globalData.code}).then((function(e){var a=e.data.expires_time-i.$Cache.time();i.$store.commit("LOGIN",{token:e.data.token,time:a}),i.$emit("authColse",!1),i.$emit("onLoadFun",e.data.userInfo),t.hideLoading()})).catch((function(e){t.hideLoading()}))},setUserInfo:function(e){var a=this;t.showLoading({title:"正在登录中"}),d.default.getCode().then((function(t){a.getUserPhoneNumber(e.detail.encryptedData,e.detail.iv,t)})).catch((function(e){t.hideLoading()}))},getLogoUrl:function(){var t=this;n.default.has(i.LOGO_URL)?this.logoUrl=n.default.get(i.LOGO_URL):(0,o.getLogo)().then((function(e){t.logoUrl=e.data.logo_url,n.default.set(i.LOGO_URL,t.logoUrl)}))},close:function(){var e=getCurrentPages();e[e.length-1];this.isGoIndex?t.navigateTo({url:"/pages/index/index"}):this.$emit("authColse",!1)}}};e.default=l}).call(this,a("543d")["default"])},"9ba6":function(t,e,a){},eca8:function(t,e,a){"use strict";var n=a("9ba6"),o=a.n(n);o.a},f8cd:function(t,e,a){"use strict";var n;a.d(e,"b",(function(){return o})),a.d(e,"c",(function(){return i})),a.d(e,"a",(function(){return n}));var o=function(){var t=this,e=t.$createElement;t._self._c},i=[]}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/Authorize-create-component',
    {
        'components/Authorize-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("3474"))
        })
    },
    [['components/Authorize-create-component']]
]);
